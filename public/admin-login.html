<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Login</title>
<style>
  body { font-family: Arial; display:flex; justify-content:center; align-items:center; height:100vh; background:#f4f4f4; }
  form { background:white; padding:30px; border-radius:10px; box-shadow:0 0 10px gray; width:300px; text-align:center; }
  input, button { width:100%; padding:10px; margin:10px 0; border-radius:5px; border:1px solid #ccc; }
  button { background:teal; color:white; border:none; cursor:pointer; }
  button:hover { background:darkcyan; }
  .error { color:red; font-size:14px; margin-top:10px; }
</style>
</head>
<body>
<form id="adminLoginForm">
  <h2>Admin Login</h2>
  <input type="email" name="email" placeholder="Email" required />
  <input type="password" name="password" placeholder="Password" required />
  <button type="submit">Login</button>
  <p class="error" id="errorMsg"></p>
</form>

<script>
const API_BASE_URL = "https://mindandmedicineholidays.onrender.com";
const errorMsg = document.getElementById("errorMsg");

document.getElementById("adminLoginForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  errorMsg.textContent = "";

  const formData = new FormData(e.target);
  const payload = { email: formData.get("email"), password: formData.get("password") };

  try {
    const res = await fetch(`${API_BASE_URL}/api/auth/login`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await res.json();

    if(res.ok && data.user.role === "admin") {
      localStorage.setItem("token", data.token);
      localStorage.setItem("role", data.user.role);
      localStorage.setItem("user", JSON.stringify(data.user));
      window.location.href = "admin-dashboard.html";
    } else {
      errorMsg.textContent = data.message || "Invalid credentials or not an admin.";
    }

  } catch(err) {
    errorMsg.textContent = "Network error: " + err.message;
  }
});
</script>
</body>
</html>

